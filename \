import { Controller } from "@hotwired/stimulus"
import { getDistance, convertDistance } from "geolib"

// Connects to data-controller="geolocation"
export default class extends Controller {
  connect() {
    window.navigator.geolocation.getCurrentPosition((position) => {
      this.element.dataset.latitude = position.coords.latitude;
      this.element.dataset.longitude = position.coords.longitude;
      const distance = getDistance(
        { latitude: position.coords.latitude, longitude: position.coords.longitude },
        { latitude: 41.6500201, longitude: -72.7342163 }
      );

      console.log('distance before: ', distance);
      console.log(convertDistance(distance, 'km'));
      console.log('distance after: ', distance);
    });
  }
}
